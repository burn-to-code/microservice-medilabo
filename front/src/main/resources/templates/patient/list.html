<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>PatientList</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>

<h1>Liste des patients</h1>

<div th:if="${param.error}" class="alert alert-danger" th:text="${param.error}"></div>


<a class="btn btn-primary" th:href="@{/patient/add}">➕ Ajouter un patient</a>


<table class="table table-striped align-middle text-center">
    <thead>
    <tr>
        <th>Prénom</th>
        <th>Nom</th>
        <th>Date de naissance</th>
        <th>Genre</th>
        <th>Adresse</th>
        <th>Téléphone</th>
        <th>Risque diabète</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="p : ${patients}">
        <td th:text="${p.firstName}"></td>
        <td th:text="${p.lastName}"></td>
        <td th:text="${p.dateOfBirth}"></td>
        <td th:text="${p.gender}"></td>
        <td th:text="${p.address}"></td>
        <td th:text="${p.phoneNumber}"></td>
        <td>
            <div th:switch="${p.riskOfDiabetes.name()}" class="d-flex align-items-center justify-content-center" style="height: 100%;">
                <span th:case="'None'" style="color: green; font-weight: bold;">Aucun risque</span>
                <span th:case="'Borderline'" style="color: blue; font-weight: bold;">Risque limité</span>
                <span th:case="'InDanger'" style="color: orange; font-weight: bold;">Danger</span>
                <span th:case="'EarlyOnSet'" style="color: red; font-weight: bold;">Apparition Précoce</span>
                <span th:case="'DonneesInsuffisantes'" style="color: purple; font-weight: bold;">Données insuffisantes</span>
                <span th:case="*">Inconnu</span>
            </div>
        </td>
        <td>
            <a class="btn btn-sm btn-primary flex-fill text-center" style="min-width:100px;"
               th:href="@{/patient/edit/{id}(id=${p.id})}">Modifier</a>
            <a class="btn btn-sm btn-primary flex-fill text-center" style="min-width:100px;"
               th:href="@{/history/{id}(id=${p.id})}">Historique</a>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>
